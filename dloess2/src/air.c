#include <stdio.h>
#include "loess.h"

struct  loess_struct    air;
double	ozone[] = {3.44821724038273, 3.30192724889463, 2.28942848510666, 
		2.6207413942089, 2.84386697985157, 2.66840164872194, 2, 
		2.51984209978975, 2.22398009056931, 2.41014226417523, 
		2.6207413942089, 2.41014226417523, 3.23961180127748, 
		1.81712059283214, 3.10723250595386, 2.22398009056931, 1, 
		2.22398009056931, 1.5874010519682, 3.1748021039364, 
		2.84386697985157, 3.55689330449006, 4.86294413109428, 
		3.33222185164595, 3.07231682568585, 4.14081774942285, 
		3.39121144301417, 2.84386697985157, 2.75892417638112, 
		3.33222185164595, 2.71441761659491, 2.28942848510666, 
		2.35133468772076, 5.12992784003009, 3.65930571002297, 
		3.1748021039364, 4, 3.41995189335339, 4.25432086511501, 
		4.59470089220704, 4.59470089220704, 4.39682967215818, 
		2.15443469003188, 3, 1.91293118277239, 3.63424118566428, 
		3.27106631018859, 3.93649718310217, 4.29084042702621, 
		3.97905720789639, 2.51984209978975, 4.30886938006377, 
		4.7622031559046, 2.71441761659491, 3.73251115681725, 
		4.34448148576861, 3.68403149864039, 4, 3.89299641587326, 
		3.39121144301417, 2.0800838230519, 2.51984209978975, 
		4.9596756638423, 4.46474509558454, 4.79141985706278, 
		3.53034833532606, 3.03658897187566, 4.02072575858906, 
		2.80203933065539, 3.89299641587326, 2.84386697985157, 
		3.14138065239139, 3.53034833532606, 2.75892417638112, 
		2.0800838230519, 3.55689330449006, 5.51784835276224, 
		4.17933919638123, 4.23582358425489, 4.90486813152402, 
		4.37951913988789, 4.39682967215818, 4.57885697021333, 
		4.27265868169792, 4.17933919638123, 4.49794144527541, 
		3.60882608013869, 3.1748021039364, 2.71441761659491, 
		2.84386697985157, 2.75892417638112, 2.88449914061482, 
		3.53034833532606, 2.75892417638112, 3.03658897187566, 
		2.0800838230519, 2.35133468772076, 3.58304787101595, 
		2.6207413942089, 2.35133468772076, 2.88449914061482, 
		2.51984209978975, 2.35133468772076, 2.84386697985157, 
		3.30192724889463, 1.91293118277239, 2.41014226417523, 
		3.10723250595386, 2.41014226417523, 2.6207413942089, 
		2.71441761659491};
double	rad_temp_wind[] = {190, 118, 149, 313, 299, 99, 19, 256, 290, 274, 65,
		334, 307, 78, 322, 44, 8, 320, 25, 92, 13, 252, 223, 279, 127,
		291, 323, 148, 191, 284, 37, 120, 137, 269, 248, 236, 175, 
		314, 276, 267, 272, 175, 264, 175, 48, 260, 274, 285, 187, 
		220, 7, 294, 223, 81, 82, 213, 275, 253, 254, 83, 24, 77, 255,
		229, 207, 192, 273, 157, 71, 51, 115, 244, 190, 259, 36, 212,
		238, 215, 203, 225, 237, 188, 167, 197, 183, 189, 95, 92, 252,
		220, 230, 259, 236, 259, 238, 24, 112, 237, 224, 27, 238, 201,
		238, 14, 139, 49, 20, 193, 191, 131, 223,
		67, 72, 74, 62, 65, 59, 61, 69, 66, 68, 58, 64, 66, 57, 68, 
		62, 59, 73, 61, 61, 67, 81, 79, 76, 82, 90, 87, 82, 77, 72, 
		65, 73, 76, 84, 85, 81, 83, 83, 88, 92, 92, 89, 73, 81, 80, 
		81, 82, 84, 87, 85, 74, 86, 85, 82, 86, 88, 86, 83, 81, 81, 
		81, 82, 89, 90, 90, 86, 82, 80, 77, 79, 76, 78, 78, 77, 72, 
		79, 81, 86, 97, 94, 96, 94, 91, 92, 93, 93, 87, 84, 80, 78, 
		75, 73, 81, 76, 77, 71, 71, 78, 67, 76, 68, 82, 64, 71, 81, 
		69, 63, 70, 75, 76, 68,
		7.4, 8, 12.6, 11.5, 8.6, 13.8, 20.1, 9.7, 9.2, 10.9, 13.2, 
		11.5, 12, 18.4, 11.5, 9.7, 9.7, 16.6, 9.7, 12, 12, 14.9, 5.7, 
		7.4, 9.7, 13.8, 11.5, 8, 14.9, 20.7, 9.2, 11.5, 10.3, 4, 9.2,
		9.2, 4.6, 10.9, 5.1, 6.3, 5.7, 7.4, 14.3, 14.9, 14.3, 6.9, 
		10.3, 6.3, 5.1, 11.5, 6.9, 8.6, 8, 8.6, 12, 7.4, 7.4, 7.4, 
		9.2, 6.9, 13.8, 7.4, 4, 10.3, 8, 11.5, 11.5, 9.7, 10.3, 6.3, 
		7.4, 10.9, 10.3, 15.5, 14.3, 9.7, 3.4, 8, 9.7, 2.3, 6.3, 6.3,
		6.9, 5.1, 2.8, 4.6, 7.4, 15.5, 10.9, 10.3, 10.9, 9.7, 14.9, 
		15.5, 6.3, 10.9, 11.5, 6.9, 13.8, 10.3, 10.3, 8, 12.6, 9.2, 
		10.3, 10.3, 16.6, 6.9, 14.3, 8, 11.5};
int32_t    n = 111, p = 3;

int
main() {
        printf("\nloess(&air):\n");
        loess_setup(rad_temp_wind, ozone, n, p, &air);
        air.model.span = 0.8;
        loess(&air);
        loess_summary(&air);        

        loess_free_mem(&air);
        return 0;
}
